@model ShoppingViewModel

<div class="container">
    <button id="filter-btn">Filter</button>
    <div id="filter-options" class="filter-collapsed">
        <h4>Store Filter</h4>
        <label for="county-select">County:</label>
        <select id="county-select" name="county" asp-for="County">
            <option value="">All</option>
            @foreach (var county in Model.DistrictCounties.Keys)
            {
                <option value="@county">@county</option>
            }
        </select>

        <label for="district-select">District:</label>
        <select id="district-select" name="district" asp-for="District">
            <option value="">All</option>
            @if (!string.IsNullOrEmpty(Model.County) && Model.DistrictCounties.ContainsKey(Model.County))
            {
                var districts = Model.DistrictCounties[Model.County];
                foreach (var district in districts)
                {
                    <option value="@district">@district</option>
                }
            }
            else
            {
                foreach (var districts in Model.DistrictCounties.Values)
                {
                    foreach (var district in districts)
                    {
                        <option value="@district">@district</option>
                    }
                }
            }
        </select>

        <h4>Product Filter</h4>
        <label for="category-select">Category:</label>
        <select id="category-select" name="category" asp-for="Category">
            <option value="">All</option>
            <option value="Electronics">Electronics</option>
            <option value="Clothing">Clothing</option>
            <option value="Home Goods">Home Goods</option>
        </select>

        <label for="price-range">Price Range:</label>
        <input type="range" id="price-range" name="price-range" asp-for="Max" min="0" max="1000" value="1000">
        <span id="price-range-value">$@Model.Max</span>
    </div>

    <table>
        <thead>
            <tr>
                <th>Product Name</th>
                <th>Price</th>
                <th>Store Name</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var product in Model.Products)
            {
                <tr>
                    <td>@product.Name</td>
                    <td>$@product.Price</td>
                    <td>@product.Store</td>
                </tr>
            }
        </tbody>
    </table>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#filter-btn').click(function () {
                $('#filter-options').toggleClass('filter-collapsed');
            });

            $('#price-range').on('input', function () {
                $('#price-range-value').text('$' + $(this).val());
                // set Min value to 0
                if ($(this).val() == 0) {
                    $('input[name="Min"]').val(null);
                }
                else {
                    $('input[name="Min"]').val(0);
                }
            });
        });
    </script>
}